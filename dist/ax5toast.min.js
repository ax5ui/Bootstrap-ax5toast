"use strict";!function(t,i){var n=ax5.util,e=function(){var t,e=this;i&&i.call(this),this.toastContainer=null,this.queue=[],this.config={clickEventName:"click",theme:"default",width:300,icon:"",closeIcon:"",msg:"",lang:{ok:"ok",cancel:"cancel"},displayTime:3e3,animateTime:250,containerPosition:"bottom-left"},t=this.config,this.init=function(){e.containerId=ax5.getGuid();var i=[];t.zIndex&&i.push("z-index:"+t.zIndex),jQuery(document.body).append('<div class="ax5-ui-toast-container '+t.containerPosition+'" data-toast-container="'+e.containerId+'" style="'+i.join(";")+'"></div>'),this.toastContainer=jQuery('[data-toast-container="'+e.containerId+'"]')},this.push=function(i,s){return e.containerId||this.init(),n.isString(i)&&(i={title:t.title,msg:i}),i.toastType="push",e.dialogConfig={},jQuery.extend(!0,e.dialogConfig,t),jQuery.extend(!0,e.dialogConfig,i),i=e.dialogConfig,this.open(i,s),this},this.confirm=function(i,s){return e.containerId||this.init(),n.isString(i)&&(i={title:t.title,msg:i}),i.toastType="confirm",e.dialogConfig={},jQuery.extend(!0,e.dialogConfig,t),jQuery.extend(!0,e.dialogConfig,i),i=e.dialogConfig,"undefined"==typeof i.btns&&(i.btns={ok:{label:t.lang.ok,theme:i.theme}}),this.open(i,s),this},this.getContent=function(t,i){var e=[];return e.push('<div id="'+t+'" data-ax5-ui="toast" class="ax5-ui-toast '+i.theme+'">'),i.icon&&(e.push('<div class="ax-toast-icon">'),e.push(i.icon||""),e.push("</div>")),e.push('<div class="ax-toast-body">'),e.push((i.msg||"").replace(/\n/g,"<br/>")),e.push("</div>"),i.btns?(e.push('<div class="ax-toast-buttons">'),e.push('<div class="ax-button-wrap">'),n.each(i.btns,function(t,i){e.push('<button type="button" data-ax-toast-btn="'+t+'" class="btn btn-'+(this.theme||"default")+'">'+this.label+"</button>")}),e.push("</div>"),e.push("</div>")):e.push('<a class="ax-toast-close" data-ax-toast-btn="ok">'+(i.closeIcon||"")+"</a>"),e.push('<div style="clear:both;"></div>'),e.push("</div>"),e.join("")},this.open=function(i,s){var o;if(i.id="ax5-toast-"+e.containerId+"-"+this.queue.length,box={width:i.width},"bottom"==n.left(t.containerPosition,"-")?this.toastContainer.append(this.getContent(i.id,i)):this.toastContainer.prepend(this.getContent(i.id,i)),o=jQuery("#"+i.id),o.css({width:box.width}),i.toastBox=o,this.queue.push(i),i&&i.onStateChanged){var a={self:this,state:"open",toastId:i.id};i.onStateChanged.call(a,a)}"push"===i.toastType?(setTimeout(function(){this.close(i,o,s)}.bind(this),t.displayTime),o.find("[data-ax-toast-btn]").on(t.clickEventName,function(t){this.btnOnClick(t||window.event,i,o,s)}.bind(this))):"confirm"===i.toastType&&o.find("[data-ax-toast-btn]").on(t.clickEventName,function(t){this.btnOnClick(t||window.event,i,o,s)}.bind(this))},this.btnOnClick=function(t,i,e,s,o,a){if(o=n.findParentNode(t.target,function(t){return t.getAttribute("data-ax-toast-btn")?!0:void 0})){a=o.getAttribute("data-ax-toast-btn");var u={key:a,value:i.btns?i.btns[a]:a,toastId:i.id,btn_target:o};i.btns&&i.btns[a].onClick?i.btns[a].onClick.call(u,a):"push"===i.toastType?(s&&s.call(u,a),this.close(i,e)):"confirm"===i.toastType&&(s&&s.call(u,a),this.close(i,e))}},this.onKeyup=function(t,i,n,e,s){t.keyCode==ax5.info.eventKeys.ESC&&this.queue.length>0&&this.close()},this.close=function(i,e,s){return"undefined"==typeof e&&(i=n.last(this.queue),e=i.toastBox),e.addClass("push"==i.toastType?"removed":"destroy"),this.queue=n.filter(this.queue,function(){return i.id!=this.id}),setTimeout(function(){var t={toastId:i.id};e.remove(),s&&s.call(t),i&&i.onStateChanged&&(t={self:this,state:"close",toastId:i.id},i.onStateChanged.call(t,t))},t.animateTime),this},this.main=function(){arguments&&n.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)};t.toast=function(){return n.isFunction(i)&&(e.prototype=new i),e}()}(ax5.ui,ax5.ui.root);