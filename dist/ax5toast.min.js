"use strict";!function(){var t=ax5.ui,n=ax5.ui.root,i=ax5.util,e="ax5toast",a="0.3.1",s=function(){var t,s=this,o=0,l=null;n&&n.call(this),this.name=e,this.version=a,this.instanceId=ax5.getGuid(),this.config={clickEventName:"click",theme:"default",width:300,icon:"",closeIcon:"",msg:"",lang:{ok:"ok",cancel:"cancel"},displayTime:3e3,animateTime:250,containerPosition:"bottom-left"},this.toastContainer=null,this.queue=[],t=this.config;var u=function(t,n){return t&&t.onStateChanged?t.onStateChanged.call(n,n):this.onStateChanged&&this.onStateChanged.call(n,n),t=null,n=null,!0},c=function(){return'\n                <div id="{{toastId}}" data-ax5-ui="toast" class="ax5-ui-toast {{theme}}">\n                    {{#icon}}\n                    <div class="ax-toast-icon">{{{.}}}</div>\n                    {{/icon}}\n                    <div class="ax-toast-body">{{{msg}}}</div>\n                    {{#btns}}\n                    <div class="ax-toast-buttons">\n                        <div class="ax-button-wrap">\n                        {{#@each}}\n                        <button type="button" data-ax-toast-btn="{{@key}}" class="btn btn-{{@value.theme}}">{{{@value.label}}}</button>\n                        {{/@each}}\n                        </div>\n                    </div>\n                    {{/btns}}\n                    {{^btns}}\n                    <a class="ax-toast-close" data-ax-toast-btn="ok">{{{closeIcon}}}</a>\n                    {{/btns}}\n                    <div style="clear:both;"></div>\n                </div>\n                '},d=function(t,n){var i={toastId:t,theme:n.theme,icon:n.icon,msg:(n.msg||"").replace(/\n/g,"<br/>"),btns:n.btns,closeIcon:n.closeIcon};try{return ax5.mustache.render(c(),i)}finally{t=null,i=null}},r=function(n,e){l&&clearTimeout(l);var a,c={width:n.width};return n.id="ax5-toast-"+s.containerId+"-"+ ++o,jQuery("#"+n.id).get(0)?this:("bottom"==i.left(t.containerPosition,"-")?this.toastContainer.append(d(n.id,n)):this.toastContainer.prepend(d(n.id,n)),a=jQuery("#"+n.id),a.css({width:c.width}),n.toastBox=a,this.queue.push(n),u.call(this,n,{self:this,state:"open",toastId:n.id}),"push"===n.toastType?(setTimeout(function(){this.close(n,e)}.bind(this),t.displayTime),a.find("[data-ax-toast-btn]").on(t.clickEventName,function(t){h.call(this,t||window.event,n,a,e)}.bind(this))):"confirm"===n.toastType&&a.find("[data-ax-toast-btn]").on(t.clickEventName,function(t){h.call(this,t||window.event,n,a,e)}.bind(this)),void(c=null))},h=function(t,n,e,a,s,o){if(s=i.findParentNode(t.target,function(t){return t.getAttribute("data-ax-toast-btn")?!0:void 0})){o=s.getAttribute("data-ax-toast-btn");var l={key:o,value:n.btns?n.btns[o]:o,toastId:n.id,btn_target:s};n.btns&&n.btns[o].onClick?n.btns[o].onClick.call(l,o):"push"===n.toastType?(a&&a.call(l,o),this.close(n,e)):"confirm"===n.toastType&&(a&&a.call(l,o),this.close(n,e))}t=null,n=null,e=null,a=null,s=null,o=null};this.init=function(){this.onStateChanged=t.onStateChanged,s.containerId=ax5.getGuid();var n=[];t.zIndex&&n.push("z-index:"+t.zIndex),jQuery(document.body).append('<div class="ax5-ui-toast-container '+t.containerPosition+'" data-toast-container="'+s.containerId+'" style="'+n.join(";")+'"></div>'),this.toastContainer=jQuery('[data-toast-container="'+s.containerId+'"]')},this.push=function(n,e){return s.containerId||this.init(),i.isString(n)&&(n={title:t.title,msg:n}),n.toastType="push",s.dialogConfig={},jQuery.extend(!0,s.dialogConfig,t,n),n=s.dialogConfig,r.call(this,n,e),n=null,e=null,this},this.confirm=function(n,e){return s.containerId||this.init(),i.isString(n)&&(n={title:t.title,msg:n}),n.toastType="confirm",s.dialogConfig={},jQuery.extend(!0,s.dialogConfig,t,n),n=s.dialogConfig,"undefined"==typeof n.btns&&(n.btns={ok:{label:t.lang.ok,theme:n.theme}}),r.call(this,n,e),n=null,e=null,this},this.close=function(n,e){"undefined"==typeof n&&(n=i.last(this.queue));var a=n.toastBox;return a.addClass("push"==n.toastType?"removed":"destroy"),this.queue=i.filter(this.queue,function(){return n.id!=this.id}),setTimeout(function(){var t={toastId:n.id};a.remove(),e&&e.call(t),t={self:this,state:"close",toastId:n.id},u.call(this,n,t),0===this.queue.length&&(l&&clearTimeout(l),l=setTimeout(function(){0===this.queue.length&&(o=0)}.bind(this),3e3)),t=null,n=null,e=null,a=null}.bind(this),t.animateTime),this},this.main=function(){root.toast_instance=root.toast_instance||[],root.toast_instance.push(this),arguments&&i.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)};t.toast=function(){return i.isFunction(n)&&(s.prototype=new n),s}()}();